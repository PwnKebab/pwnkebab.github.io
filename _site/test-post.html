<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Test Post</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Test Post" />
<meta name="author" content="PwnKebab" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Just another blog" />
<meta property="og:description" content="Just another blog" />
<link rel="canonical" href="http://0.0.0.0:4000/test-post.html" />
<meta property="og:url" content="http://0.0.0.0:4000/test-post.html" />
<meta property="og:site_name" content="PwnKebab" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-02-27T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Test Post" />
<script type="application/ld+json">
{"url":"http://0.0.0.0:4000/test-post.html","headline":"Test Post","dateModified":"2024-02-27T00:00:00+00:00","datePublished":"2024-02-27T00:00:00+00:00","author":{"@type":"Person","name":"PwnKebab"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/test-post.html"},"@type":"BlogPosting","description":"Just another blog","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="PwnKebab" /><link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head><body a="dark">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">cd ..</a><link rel="stylesheet" href="/assets/css/github.css" />
<article>
  <p class="post-meta">
    <time datetime="2024-02-27 00:00:00 +0000">2024-02-27</time>
  </p>
  
  <h1>Test Post</h1>

  <p><img src="/static/test_post/4838856.png" alt="test" /></p>

<h2 id="header-1">Header 1</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/stat.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">chall</span><span class="p">{</span>
	<span class="kt">char</span> <span class="n">filebuff</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">str1</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">str2</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="p">}</span><span class="n">chall_t</span><span class="p">;</span>

<span class="n">chall_t</span> <span class="n">mychall</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">pMenu</span><span class="p">(){</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"[1] Leer un archivo TUYO"</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"[2] Leer str1 de stdin"</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"[3] Copiar str1 a str2"</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"[4] Copiar str2 a str1"</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"[5] Escribir str1 a stdout"</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"[s] Salir"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">readOwnedFile</span><span class="p">(){</span>
	<span class="k">struct</span> <span class="n">stat</span> <span class="n">statbuf</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">filename</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"File: </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="n">fgets</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
	<span class="kt">char</span> <span class="o">*</span> <span class="n">n</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="sc">'\n'</span><span class="p">);</span>
	<span class="n">n</span><span class="o">?</span> <span class="p">(</span><span class="o">*</span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str1</span><span class="p">[</span><span class="mi">1023</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">getchar</span><span class="p">());</span>
	<span class="n">stat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">statbuf</span><span class="p">);</span> 
	<span class="k">if</span><span class="p">(</span><span class="n">statbuf</span><span class="p">.</span><span class="n">st_uid</span> <span class="o">==</span> <span class="n">getuid</span><span class="p">()){</span> 
		<span class="kt">FILE</span> <span class="o">*</span> <span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
		<span class="n">fgets</span><span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">filebuff</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
		<span class="n">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"Error: acceso no permitido</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">readStr1</span><span class="p">(){</span>
	<span class="n">fgets</span><span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str1</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
	<span class="kt">char</span> <span class="o">*</span> <span class="n">n</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str1</span><span class="p">,</span> <span class="sc">'\n'</span><span class="p">);</span>
	<span class="n">n</span><span class="o">?</span> <span class="p">(</span><span class="o">*</span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str1</span><span class="p">[</span><span class="mi">1023</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">getchar</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">str1tostr2</span><span class="p">(){</span>
	<span class="n">__asm__</span> <span class="k">goto</span><span class="p">(</span><span class="s">"test %0, %0;"</span>
			<span class="s">"jz %l3;"</span>
			<span class="s">"xor rcx, rcx;"</span>
			<span class="s">"mov ecx, %0;"</span>
			<span class="s">"lea rdi, %1;"</span>
			<span class="s">"lea rsi, %2;"</span>
			<span class="s">"rep movsb;"</span>
			<span class="o">:</span> 
			<span class="o">:</span> <span class="s">"r"</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">strlen</span><span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str1</span><span class="p">)),</span> <span class="s">"m"</span> <span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str2</span><span class="p">),</span> <span class="s">"m"</span> <span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str1</span><span class="p">)</span>
			<span class="o">:</span> <span class="s">"rcx"</span><span class="p">,</span> <span class="s">"rdi"</span><span class="p">,</span> <span class="s">"rsi"</span><span class="p">,</span> <span class="s">"memory"</span>
			<span class="o">:</span> <span class="n">end</span>
			<span class="p">);</span>
	<span class="nl">end:</span>
	<span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">str2tostr1</span><span class="p">(){</span>
	<span class="n">__asm__</span> <span class="k">goto</span><span class="p">(</span><span class="s">"std;"</span>
			<span class="s">"test %0, %0;"</span>
			<span class="s">"jz %l3;"</span>
			<span class="s">"mov rcx, %0;"</span>
			<span class="s">"sub %0, 1;"</span>
			<span class="s">"lea rdi, %1;"</span>
			<span class="s">"add rdi, %0;"</span>
			<span class="s">"lea rsi, %2;"</span>
			<span class="s">"add rsi, %0;"</span>
			<span class="s">"rep movsb;"</span>
			<span class="s">"cld;"</span>
			<span class="o">:</span> 
			<span class="o">:</span> <span class="s">"r"</span> <span class="p">((</span><span class="kt">long</span><span class="p">)</span><span class="n">strlen</span><span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str2</span><span class="p">)),</span> <span class="s">"m"</span> <span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str1</span><span class="p">),</span> <span class="s">"m"</span> <span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str2</span><span class="p">)</span>
			<span class="o">:</span> <span class="s">"rcx"</span><span class="p">,</span> <span class="s">"rdi"</span><span class="p">,</span> <span class="s">"rsi"</span><span class="p">,</span> <span class="s">"memory"</span>
			<span class="o">:</span> <span class="n">end</span>
			<span class="p">);</span>
	<span class="nl">end:</span>
	<span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="k">const</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="n">setvbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">setvbuf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">pMenu</span><span class="p">();</span>
		<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">option</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span> <span class="n">getchar</span><span class="p">();</span>
		<span class="n">getchar</span><span class="p">();</span>
		<span class="k">switch</span><span class="p">(</span><span class="n">option</span><span class="p">){</span>
			<span class="k">case</span> <span class="sc">'1'</span><span class="p">:</span>	<span class="n">readOwnedFile</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="sc">'2'</span><span class="p">:</span>	<span class="n">readStr1</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="sc">'3'</span><span class="p">:</span>	<span class="n">str1tostr2</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="sc">'4'</span><span class="p">:</span>	<span class="n">str2tostr1</span><span class="p">();</span><span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="sc">'5'</span><span class="p">:</span>	<span class="n">puts</span><span class="p">(</span><span class="n">mychall</span><span class="p">.</span><span class="n">str1</span><span class="p">);</span><span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="sc">'s'</span><span class="p">:</span> 	<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
			<span class="nl">default:</span> 	<span class="n">puts</span><span class="p">(</span><span class="s">"[!] Opcion incorrecta"</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

</article>
      </div>
    </main>
  </body>
</html>